<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="于乐Yule"><meta name="description" content="邪王真眼是最强的！"><meta name="keywords" content=""><title>缓存转移开源</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github-dark.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;800&amp;display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;800&amp;display=swap"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>缓存转移开源</h1><div class="post-info"><span>2024-09-28 08:08:09</span><span class="tags"><a href="/tags/Android%E6%90%9E%E6%9C%BA/">#Android搞机</a><a href="/tags/Shell/">#Shell</a><a href="/tags/%E8%84%9A%E6%9C%AC/">#脚本</a></span></div></div><article> <div class="content"><h2 id="V1-0">V1.0</h2>
<blockquote>
<p>首次上传</p>
</blockquote>
<pre><code class="hljs bash"><span class="hljs-comment"># by 酷安@于乐Yule</span>
<span class="hljs-comment"># 二改二传标明出处</span>

<span class="hljs-comment"># 输出目录</span>
output=<span class="hljs-string">&quot;/storage/emulated/0/Download/缓存转移&quot;</span>

<span class="hljs-comment"># 日志目录</span>
<span class="hljs-built_in">log</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$output</span>/log.log&quot;</span>

<span class="hljs-comment"># R · G · B</span>
GR=<span class="hljs-string">&quot;\033[1;32m&quot;</span>     <span class="hljs-comment"># 绿</span>
YE=<span class="hljs-string">&quot;\033[1;33m&quot;</span>     <span class="hljs-comment"># 黄</span>
CY=<span class="hljs-string">&quot;\033[1;34m&quot;</span>     <span class="hljs-comment"># 紫</span>
BL=<span class="hljs-string">&quot;\033[1;36m&quot;</span>     <span class="hljs-comment"># 蓝</span>
RE=<span class="hljs-string">&quot;\033[1;31m&quot;</span>     <span class="hljs-comment"># 红</span>
WH=<span class="hljs-string">&quot;\033[1;37m&quot;</span>     <span class="hljs-comment"># 白</span>
BO=<span class="hljs-string">&quot;\033[1m&quot;</span>        <span class="hljs-comment"># 粗体</span>
RES=<span class="hljs-string">&quot;\033[0m&quot;</span>       <span class="hljs-comment"># 结束</span>

<span class="hljs-comment"># 更符合中国宝宝阅读习惯的echo</span>
<span class="hljs-function"><span class="hljs-title">yule</span></span>() &#123; 
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot; <span class="hljs-variable">$1</span>&quot;</span>
&#125;
<span class="hljs-function"><span class="hljs-title">yulen</span></span>() &#123; 
    <span class="hljs-built_in">echo</span> -en <span class="hljs-string">&quot; <span class="hljs-variable">$1</span>&quot;</span>
&#125;
<span class="hljs-function"><span class="hljs-title">sepa</span></span>() &#123;
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;-------------------------------&quot;</span>
&#125;
<span class="hljs-function"><span class="hljs-title">blank</span></span>() &#123;
    <span class="hljs-built_in">local</span> n=<span class="hljs-variable">$&#123;1:-1&#125;</span>
    <span class="hljs-keyword">if</span> ! [[ <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> =~ ^[0-9]+$ ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;注意: &#x27;blank&#x27;函数的参数不能为0或负数&quot;</span> &gt;&amp;2
        <span class="hljs-built_in">return</span> 1
    <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">for</span> ((i=<span class="hljs-number">1</span>; i&lt;=n; i++)); <span class="hljs-keyword">do</span>
        <span class="hljs-built_in">echo</span>
    <span class="hljs-keyword">done</span>
&#125;

<span class="hljs-comment"># json 阅读函数</span>
<span class="hljs-function"><span class="hljs-title">jsonread</span></span>() &#123;
    <span class="hljs-built_in">local</span> file_path=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span>
    <span class="hljs-built_in">local</span> json_key=<span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span>
    <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$file_path</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;错误：文件 <span class="hljs-variable">$file_path</span> 不存在。&quot;</span>
        <span class="hljs-built_in">return</span> 1
    <span class="hljs-keyword">fi</span>
    <span class="hljs-built_in">local</span> value=$(grep -o <span class="hljs-string">&quot;\&quot;<span class="hljs-variable">$json_key</span>\&quot;[[:space:]]*:[[:space:]]*\&quot;[^\&quot;]*\&quot;&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$file_path</span>&quot;</span> | sed -n <span class="hljs-string">&quot;s/.*: *\&quot;\(.*\)\&quot;.*/\1/p&quot;</span>)
    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$value</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;错误：未找到键 <span class="hljs-variable">$json_key</span>。&quot;</span>
        <span class="hljs-built_in">return</span> 1
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;<span class="hljs-variable">$value</span>&quot;</span>
    <span class="hljs-keyword">fi</span>
&#125;

<span class="hljs-comment"># 日志输出函数</span>
<span class="hljs-function"><span class="hljs-title">dlog</span></span>() &#123;
    <span class="hljs-built_in">local</span> datetime=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)
    <span class="hljs-built_in">local</span> exit_status=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[<span class="hljs-variable">$datetime</span>] 操作: <span class="hljs-variable">$exit_status</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$log</span>
&#125;
<span class="hljs-function"><span class="hljs-title">errlog</span></span>() &#123;
    <span class="hljs-built_in">local</span> datetime=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)
    <span class="hljs-built_in">local</span> exit_status=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[<span class="hljs-variable">$datetime</span>] 错误: <span class="hljs-variable">$exit_status</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$log</span>
&#125;
<span class="hljs-function"><span class="hljs-title">finlog</span></span>() &#123;
    <span class="hljs-built_in">local</span> datetime=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)
    <span class="hljs-built_in">local</span> exit_status=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[<span class="hljs-variable">$datetime</span>] 完成: <span class="hljs-variable">$exit_status</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$log</span>
&#125;

<span class="hljs-comment"># 卡死判断函数</span>
<span class="hljs-function"><span class="hljs-title">jam</span></span>() &#123;
    <span class="hljs-built_in">local</span> i
    <span class="hljs-built_in">local</span> err_num_yule=<span class="hljs-variable">$1</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$err_num_yule</span> -lt <span class="hljs-string">&quot;10&quot;</span> ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;0..4&#125;; <span class="hljs-keyword">do</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[1G&quot;</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[K&quot;</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[A&quot;</span>
        <span class="hljs-keyword">done</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> &#123;0..1&#125;; <span class="hljs-keyword">do</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[1G&quot;</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[K&quot;</span>
            <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[A&quot;</span>
        <span class="hljs-keyword">done</span>
    <span class="hljs-keyword">fi</span>
    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;\033[B\033[1G&quot;</span>
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>输入错误，请输入[1]/[2]/[3]<span class="hljs-variable">$&#123;RES&#125;</span>，你的输入：<span class="hljs-variable">$2</span>&quot;</span>
    yule <span class="hljs-string">&quot;再错误<span class="hljs-variable">$err_num_yule</span>次会退出脚本&quot;</span>
&#125;

<span class="hljs-comment"># 微信操作部分函数</span>
<span class="hljs-function"><span class="hljs-title">wechatdo</span></span>() &#123;
    sepa
    <span class="hljs-built_in">cd</span> /data/data/com.tencent.mm/MicroMsg/<span class="hljs-variable">$&#123;1&#125;</span>/attachment
    wechat_file_num=$(<span class="hljs-built_in">ls</span> -C | <span class="hljs-built_in">wc</span> -l)
    wechatfilecopy=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">ls</span> -C
    sepa
    yule <span class="hljs-string">&quot;共有：<span class="hljs-variable">$&#123;YE&#125;</span><span class="hljs-variable">$&#123;wechat_file_num&#125;</span>个文件<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yule <span class="hljs-string">&quot;输入<span class="hljs-variable">$&#123;YE&#125;</span>[y]<span class="hljs-variable">$&#123;RES&#125;</span>进行确认，[n]取消&quot;</span>
    blank
    yulen <span class="hljs-string">&quot;请输入: &quot;</span>
    <span class="hljs-built_in">read</span> wechat_choice
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$wechat_choice</span> == <span class="hljs-string">&quot;y&quot;</span> ]]; <span class="hljs-keyword">then</span>
        sepa
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>- 复制文件...<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 创建./微信/&quot;</span>
        <span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/微信&quot;</span> 2&gt;/dev/null
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 移动文件到./微信/&quot;</span>
        <span class="hljs-built_in">cp</span> /data/data/com.tencent.mm/MicroMsg/<span class="hljs-variable">$&#123;wechatfilecopy&#125;</span>/attachment/* <span class="hljs-variable">$&#123;output&#125;</span>/微信 2&gt;/<span class="hljs-variable">$&#123;output&#125;</span>/error
        err=$?
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        <span class="hljs-comment"># 复制成功</span>
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$err</span> == <span class="hljs-string">&quot;0&quot;</span> ]]; <span class="hljs-keyword">then</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>· 复制完成<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            sepa
            <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$delete</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
                <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$dir</span>/*
                yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>删除源文件成功<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            <span class="hljs-keyword">fi</span>
            finlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]转移成功&quot;</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>已完成转移<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;路径<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span>
        <span class="hljs-comment"># 复制失败，输出日志</span>
        <span class="hljs-keyword">else</span>
            blank
            sepa
            blank 2                        
            errtext=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/error)           
            yule <span class="hljs-string">&quot;ERR: <span class="hljs-variable">$errtext</span>&quot;</span>
            errlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]复制文件失败: <span class="hljs-variable">$errtext</span>&quot;</span>
            blank 2
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>· 复制出错，请检查：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;  1.存储空间是否足够&quot;</span>
            yule <span class="hljs-string">&quot;  2.是否未下载文件&quot;</span>
            yule <span class="hljs-string">&quot;  3.软件是否为旧版&quot;</span>
            yule <span class="hljs-string">&quot;  4.是否未授权Root&quot;</span>
        <span class="hljs-keyword">fi</span>        
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$wechat_choice</span> == <span class="hljs-string">&quot;n&quot;</span> ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">exit</span> 0
    <span class="hljs-keyword">else</span>
        blank
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>输入错误<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        <span class="hljs-built_in">exit</span> 0
    <span class="hljs-keyword">fi</span>
&#125;

<span class="hljs-comment"># 哔哩哔哩操作函数</span>
<span class="hljs-function"><span class="hljs-title">bilido</span></span>() &#123; 
    clear
    blank 2
    find <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;entry.json&#x27;</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r filedir; <span class="hljs-keyword">do</span>
        prev=$(<span class="hljs-built_in">dirname</span> <span class="hljs-variable">$&#123;filedir&#125;</span>)
        foldersize=$(<span class="hljs-built_in">du</span> -sh <span class="hljs-variable">$prev</span> 2&gt;/dev/null | <span class="hljs-built_in">cut</span> -f1 2&gt;/dev/null)
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$filedir</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$&#123;output&#125;</span>/bili
        nowwechatnum=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/bili | <span class="hljs-built_in">wc</span> -l)
        yulen <span class="hljs-string">&quot;<span class="hljs-variable">$nowwechatnum</span>&quot;</span>
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span><span class="hljs-subst">$(jsonread $filedir <span class="hljs-string">&quot;title&quot;</span>)</span><span class="hljs-variable">$&#123;RES&#125;</span> | <span class="hljs-variable">$&#123;YE&#125;</span>$foldersize<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    <span class="hljs-keyword">done</span>
    sepa
    yule <span class="hljs-string">&quot;找到 <span class="hljs-variable">$&#123;YE&#125;</span><span class="hljs-subst">$(cat $&#123;output&#125;/bili | wc -l)</span><span class="hljs-variable">$&#123;RES&#125;</span> 个视频&quot;</span>
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>[y]确定开始<span class="hljs-variable">$&#123;RES&#125;</span>   <span class="hljs-variable">$&#123;RE&#125;</span>[n]取消并退出<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    <span class="hljs-built_in">read</span> bili_choice
    <span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/bili
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$bili_choice</span> == <span class="hljs-string">&quot;y&quot;</span> ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-comment"># 转移步骤</span>
        <span class="hljs-comment"># 创建视频同名文件夹</span>
        sepa
        <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩
        find <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;entry.json&#x27;</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r filedir; <span class="hljs-keyword">do</span>
            folder_name=$(jsonread <span class="hljs-variable">$filedir</span> <span class="hljs-string">&quot;title&quot;</span>)
            <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩/<span class="hljs-variable">$&#123;folder_name&#125;</span> 2&gt;/dev/null
            <span class="hljs-comment"># 复制 m4s 和 json 文件到目录</span>
            prev=$(<span class="hljs-built_in">dirname</span> <span class="hljs-variable">$&#123;filedir&#125;</span>)
            audio=$(find <span class="hljs-string">&quot;<span class="hljs-variable">$prev</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;audio.m4s&#x27;</span>)
            <span class="hljs-built_in">cp</span> <span class="hljs-variable">$audio</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩/<span class="hljs-variable">$&#123;folder_name&#125;</span> 2&gt;/dev/null
            video=$(find <span class="hljs-string">&quot;<span class="hljs-variable">$prev</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;video.m4s&#x27;</span>)
            <span class="hljs-built_in">cp</span> <span class="hljs-variable">$video</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩/<span class="hljs-variable">$&#123;folder_name&#125;</span> 2&gt;/dev/null
            danmaku=$(find <span class="hljs-string">&quot;<span class="hljs-variable">$prev</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;danmaku.xml&#x27;</span>)
            <span class="hljs-built_in">cp</span> <span class="hljs-variable">$danmaku</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩/<span class="hljs-variable">$&#123;folder_name&#125;</span> 2&gt;/dev/null
            info=$(find <span class="hljs-string">&quot;<span class="hljs-variable">$prev</span>&quot;</span> -maxdepth 10 -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&#x27;entry.json&#x27;</span>)
            <span class="hljs-built_in">cp</span> <span class="hljs-variable">$info</span> <span class="hljs-variable">$&#123;output&#125;</span>/哔哩哔哩/<span class="hljs-variable">$&#123;folder_name&#125;</span> 2&gt;/dev/null
        <span class="hljs-keyword">done</span>
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$delete</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$dir</span>/*
        <span class="hljs-keyword">fi</span>
        finlog <span class="hljs-string">&quot;[哔哩哔哩]转移成功&quot;</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">exit</span> 0
    <span class="hljs-keyword">fi</span>
&#125;

<span class="hljs-comment"># 脚本操作部分</span>
    <span class="hljs-comment"># dir：文件路径</span>
    <span class="hljs-comment"># type：</span>
        <span class="hljs-comment"># 1 表示目录用文件夹进行了分类，此时下面的suf不生效</span>
        <span class="hljs-comment"># 0 表示文件夹内就是要移动的文件</span>
    <span class="hljs-comment"># suf：要搜寻的文件后缀名，type 为 1 时不生效，使用 | 分割，all 表示所有文件</span>
<span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;
    <span class="hljs-comment"># 定义哔哩哔哩的信息</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;1&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;哔哩哔哩&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/tv.danmaku.bili/download/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-comment"># 哔哩哔哩对视频做了文件夹区分</span>
        suf=<span class="hljs-string">&quot;.m4s|.json&quot;</span>
    <span class="hljs-comment"># 定义微信的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;2&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;微信&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/data/data/com.tencent.mm/MicroMsg/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-comment"># 微信对账号做了文件夹区分</span>
        suf=<span class="hljs-string">&quot;wechat file&quot;</span>
    <span class="hljs-comment"># 定义QQ的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;3&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;QQ&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/com.tencent.mobileqq/Tencent/QQfile_recv/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-comment"># 排除子文件夹</span>
        suf=<span class="hljs-string">&quot;all&quot;</span>
    <span class="hljs-comment"># 定义Nekogram的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;4&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;Nekogram&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/tw.nekomimi.nekogram/files/Telegram/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span>
        suf=<span class="hljs-string">&quot;all&quot;</span>
    <span class="hljs-keyword">fi</span>
    main2
&#125;
    
<span class="hljs-function"><span class="hljs-title">main2</span></span>() &#123;
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>你选择了<span class="hljs-variable">$&#123;RES&#125;</span> [<span class="hljs-variable">$&#123;BL&#125;</span> <span class="hljs-variable">$name</span> <span class="hljs-variable">$&#123;RES&#125;</span>]&quot;</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$menu</span> != <span class="hljs-string">&quot;2&quot;</span> ]]; <span class="hljs-keyword">then</span>
        size=$(<span class="hljs-built_in">du</span> -sh <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span>&quot;</span> | <span class="hljs-built_in">cut</span> -f1)
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>目录大小：<span class="hljs-variable">$&#123;size&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    <span class="hljs-keyword">fi</span>      
    blank
    
    <span class="hljs-comment"># 询问用户是否要删除源文件</span>
    yulen <span class="hljs-string">&quot;是否<span class="hljs-variable">$&#123;RE&#125;</span>删除原文件<span class="hljs-variable">$&#123;RES&#125;</span> (yes / no): &quot;</span>
    <span class="hljs-built_in">read</span> delete    
    blank
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$delete</span> <span class="hljs-keyword">in</span>
        <span class="hljs-built_in">yes</span>)
            yule <span class="hljs-string">&quot;操作完成后会删除源文件哦&quot;</span>
            ;;
        no)
            yule <span class="hljs-string">&quot;操作完成后不会删除源文件哦&quot;</span>
            ;;
        *|\n)
            yule <span class="hljs-string">&quot;输入错误，奖励退出脚本哦&quot;</span>
            <span class="hljs-built_in">exit</span> 1
            ;;
    <span class="hljs-keyword">esac</span>
    main3
&#125;

<span class="hljs-function"><span class="hljs-title">main3</span></span>() &#123;
    <span class="hljs-comment"># 面向 type 0 | suf all 进行操作</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$type</span> == <span class="hljs-string">&quot;0&quot;</span> &amp;&amp; <span class="hljs-variable">$suf</span> == <span class="hljs-string">&quot;all&quot;</span> ]]; <span class="hljs-keyword">then</span>
        sepa
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>- 复制文件...<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 创建./<span class="hljs-variable">$name</span>/&quot;</span>
        <span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span> 2&gt;/dev/null
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 移动文件到./<span class="hljs-variable">$name</span>/&quot;</span>
        find <span class="hljs-variable">$dir</span> -maxdepth 1 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> &#123;&#125; <span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span> \; 2&gt;/<span class="hljs-variable">$&#123;output&#125;</span>/error
        err=$?
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        <span class="hljs-comment"># 复制成功</span>
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$err</span> == <span class="hljs-string">&quot;0&quot;</span> ]]; <span class="hljs-keyword">then</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>· 复制完成<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            sepa
            <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$delete</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
                <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$dir</span>/*
                yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>删除源文件成功<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            <span class="hljs-keyword">fi</span>
            finlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]转移成功&quot;</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>已完成转移<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;路径<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span>
        <span class="hljs-comment"># 复制失败，输出日志</span>
        <span class="hljs-keyword">else</span>
            blank
            sepa
            blank 2                        
            errtext=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/error)           
            yule <span class="hljs-string">&quot;ERR: <span class="hljs-variable">$errtext</span>&quot;</span>
            errlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]复制文件失败: <span class="hljs-variable">$errtext</span>&quot;</span>
            blank 2
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>· 复制出错，请检查：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;  1.存储空间是否足够&quot;</span>
            yule <span class="hljs-string">&quot;  2.是否未下载文件&quot;</span>
            yule <span class="hljs-string">&quot;  3.软件是否为旧版&quot;</span>
            yule <span class="hljs-string">&quot;  4.是否未授权Root&quot;</span>
            <span class="hljs-built_in">exit</span> 1
        <span class="hljs-keyword">fi</span>
        
    <span class="hljs-comment"># 面向 type 1 | suf all 进行操作</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$type</span> == <span class="hljs-string">&quot;1&quot;</span> &amp;&amp; <span class="hljs-variable">$suf</span> == <span class="hljs-string">&quot;all&quot;</span> ]]; <span class="hljs-keyword">then</span>
        sepa
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>- 复制文件...<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 创建./<span class="hljs-variable">$name</span>/&quot;</span>
        <span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span> 2&gt;/dev/null
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yulen <span class="hljs-string">&quot;· 移动文件到./<span class="hljs-variable">$name</span>/&quot;</span>
        <span class="hljs-built_in">cp</span> -r <span class="hljs-variable">$&#123;dir&#125;</span>* <span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$&#123;name&#125;</span> 2&gt;/<span class="hljs-variable">$&#123;output&#125;</span>/error
        err=$?
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        <span class="hljs-comment"># 复制成功</span>
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$err</span> == <span class="hljs-string">&quot;0&quot;</span> ]]; <span class="hljs-keyword">then</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>· 复制完成<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            sepa
            <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$delete</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
                <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$dir</span>/*
                yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>删除源文件成功<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            <span class="hljs-keyword">fi</span>
            finlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]转移成功&quot;</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>已完成转移<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;路径<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span>
        <span class="hljs-comment"># 复制失败，输出日志</span>
        <span class="hljs-keyword">else</span>
            blank
            sepa
            blank 2                        
            errtext=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/error)           
            yule <span class="hljs-string">&quot;ERR: <span class="hljs-variable">$errtext</span>&quot;</span>
            errlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]复制文件失败: <span class="hljs-variable">$errtext</span>&quot;</span>
            blank 2
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>· 复制出错，请检查：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            yule <span class="hljs-string">&quot;  1.存储空间是否足够&quot;</span>
            yule <span class="hljs-string">&quot;  2.是否未下载文件&quot;</span>
            yule <span class="hljs-string">&quot;  3.软件是否为旧版&quot;</span>
            yule <span class="hljs-string">&quot;  4.是否未授权Root&quot;</span>
            <span class="hljs-built_in">exit</span> 1
        <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># 面向 微信 的操作</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$name</span> == <span class="hljs-string">&quot;微信&quot;</span> ]]; <span class="hljs-keyword">then</span>
        clear
        blank 2
        <span class="hljs-built_in">cd</span> <span class="hljs-variable">$dir</span> 2&gt;/dev/null
        foldernum=$(find <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span>&quot;</span> -maxdepth 1 -<span class="hljs-built_in">type</span> d -name <span class="hljs-string">&quot;????????????????????????????????&quot;</span> | <span class="hljs-built_in">wc</span> -l)
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$foldernum</span> -gt <span class="hljs-string">&quot;1&quot;</span> ]]; <span class="hljs-keyword">then</span>
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>您登录过 <span class="hljs-variable">$foldernum</span> 个微信号，产生了多个目录<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            sepa
            yule <span class="hljs-string">&quot;请选择一个目录进行查看：&quot;</span>
            find <span class="hljs-string">&quot;<span class="hljs-variable">$dir</span>&quot;</span> -maxdepth 1 -<span class="hljs-built_in">type</span> d -name <span class="hljs-string">&quot;????????????????????????????????&quot;</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r folderdir; <span class="hljs-keyword">do</span>
                foldername=$(<span class="hljs-built_in">basename</span> <span class="hljs-variable">$folderdir</span>)
                foldersize=$(<span class="hljs-built_in">du</span> -sh <span class="hljs-variable">$&#123;folderdir&#125;</span>/attachment 2&gt;/dev/null | <span class="hljs-built_in">cut</span> -f1 2&gt;/dev/null)
                <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$foldersize</span> == <span class="hljs-string">&quot;&quot;</span> ]]; <span class="hljs-keyword">then</span>
                    foldersize=<span class="hljs-string">&quot;0KB&quot;</span>
                <span class="hljs-keyword">fi</span>
                <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$foldername</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$&#123;output&#125;</span>/wechat
                nowwechatnum=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/wechat | <span class="hljs-built_in">wc</span> -l)
                yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>[<span class="hljs-variable">$nowwechatnum</span>]&quot;</span>
                yule <span class="hljs-string">&quot;账号:<span class="hljs-variable">$&#123;CY&#125;</span>$foldername<span class="hljs-variable">$&#123;RES&#125;</span> | <span class="hljs-variable">$&#123;YE&#125;</span>$foldersize<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
            <span class="hljs-keyword">done</span>
            yule <span class="hljs-string">&quot;- 当前脚本版本最多可支持6个微信号&quot;</span>
            sepa
            yulen <span class="hljs-string">&quot;请输入[序号]: &quot;</span>
            <span class="hljs-built_in">read</span> wechat_account
            <span class="hljs-keyword">case</span> <span class="hljs-variable">$wechat_account</span> <span class="hljs-keyword">in</span>
                1)
                    account_c=$(sed -n <span class="hljs-string">&quot;1p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                2)
                    account_c=$(sed -n <span class="hljs-string">&quot;2p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                3)
                    account_c=$(sed -n <span class="hljs-string">&quot;3p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                4)
                    account_c=$(sed -n <span class="hljs-string">&quot;4p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                5)
                    account_c=$(sed -n <span class="hljs-string">&quot;5p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                6)
                    account_c=$(sed -n <span class="hljs-string">&quot;6p&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/wechat&quot;</span>)
                    yule <span class="hljs-string">&quot;你选择了 <span class="hljs-variable">$&#123;BL&#125;</span><span class="hljs-variable">$&#123;account_c&#125;</span><span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    wechatdo <span class="hljs-variable">$&#123;account_c&#125;</span>
                    ;;
                *)
                    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>选择错误或超出最大账号限制<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
                    <span class="hljs-built_in">exit</span> 1
                    ;;
            <span class="hljs-keyword">esac</span>
            <span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/wechat
        <span class="hljs-keyword">else</span>
            <span class="hljs-built_in">exit</span> 0
        <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># 面向哔哩哔哩的操作</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$name</span> == <span class="hljs-string">&quot;哔哩哔哩&quot;</span> ]]; <span class="hljs-keyword">then</span>
        bilido
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-comment"># 生成本次配置的 json</span>
    <span class="hljs-built_in">touch</span> <span class="hljs-variable">$&#123;output&#125;</span>/last.json
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&#123;\&quot;name\&quot;:\&quot;<span class="hljs-variable">$name</span>\&quot;,\&quot;type\&quot;:\&quot;<span class="hljs-variable">$type</span>\&quot;,\&quot;suf\&quot;:\&quot;<span class="hljs-variable">$suf</span>\&quot;,\&quot;dir\&quot;:\&quot;<span class="hljs-variable">$dir</span>\&quot;,\&quot;del\&quot;:\&quot;<span class="hljs-variable">$delete</span>\&quot;,\&quot;data\&quot;:\&quot;<span class="hljs-subst">$(date +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span>\&quot;&#125;&quot;</span> &gt; <span class="hljs-variable">$&#123;output&#125;</span>/last.json
    <span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/error
    <span class="hljs-built_in">exit</span> 0
&#125;

<span class="hljs-comment"># 脚本菜单部分</span>
<span class="hljs-function"><span class="hljs-title">menu</span></span>() &#123;
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>欢迎使用《缓存转移》<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    sepa
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>- 哔哩哔哩    [1]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>- 微信        [2]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>- QQ          [3]&quot;</span>
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>- Nekogram    [4]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    <span class="hljs-comment"># 选择菜单</span>
    <span class="hljs-keyword">for</span> err_num_2 <span class="hljs-keyword">in</span> &#123;10..0&#125;; <span class="hljs-keyword">do</span>
        sepa
        yulen <span class="hljs-string">&quot;请输入[1]/[2]/[3]/[4]：&quot;</span>    
        <span class="hljs-built_in">read</span> menu_2
        <span class="hljs-keyword">case</span> <span class="hljs-variable">$menu_2</span> <span class="hljs-keyword">in</span>
            1)
                <span class="hljs-comment"># 哔哩哔哩</span>
                menu=1
                main
                ;;
            2)
                <span class="hljs-comment"># 微信</span>
                menu=2
                main
                ;;
            3)
                <span class="hljs-comment"># QQ</span>
                menu=3
                main
                ;;
            4)
                <span class="hljs-comment"># Nekogram</span>
                menu=4
                main
                ;;
            *|\n)
                <span class="hljs-comment"># 输入错误</span>
                jam <span class="hljs-variable">$err_num_2</span> <span class="hljs-variable">$menu_2</span>
                ;;
        <span class="hljs-keyword">esac</span>
    <span class="hljs-keyword">done</span>
&#125;

<span class="hljs-comment"># 主标题：CY</span>
<span class="hljs-comment"># 副标题：YE</span>
<span class="hljs-comment"># 三级文字：BL</span>
<span class="hljs-comment"># 文字：WH (没有)</span>

<span class="hljs-comment"># 脚本介绍</span>
<span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$log</span>&quot;</span>
<span class="hljs-built_in">touch</span> /storage/emulated/0/Download/缓存转移/log.log
<span class="hljs-keyword">if</span> [ -e <span class="hljs-string">&quot;<span class="hljs-variable">$log</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;日志文件存在&quot;</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">touch</span> <span class="hljs-string">&quot;<span class="hljs-variable">$log</span>&quot;</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/wechat
<span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/bili
<span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/error
clear

<span class="hljs-comment"># 读取上一次保存的配置</span>
<span class="hljs-keyword">if</span> [[ -e <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/last.json&quot;</span> ]]; <span class="hljs-keyword">then</span>
    blank 2
    yule <span class="hljs-string">&quot;上次配置：&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;data&quot;</span>
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>应用名：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;name&quot;</span>
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>路径：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;dir&quot;</span>
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>是否已分类：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;type&quot;</span>
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>移动的文件后缀：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;suf&quot;</span>
    blank 2
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>完成后删除源文件：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;&quot;</span>
    jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;del&quot;</span>
    blank 2
    sepa
    yulen <span class="hljs-string">&quot;要用上一次的配置吗(yes / no): &quot;</span>
    <span class="hljs-built_in">read</span> last
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$last</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=$(jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;name&quot;</span>)
        <span class="hljs-built_in">dir</span>=$(jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;dir&quot;</span>)
        <span class="hljs-built_in">type</span>=$(jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;type&quot;</span>)
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$type</span>&quot;</span>
        <span class="hljs-built_in">sleep</span> 5
        delete=$(jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;del&quot;</span>)
        suf=$(jsonread <span class="hljs-variable">$&#123;output&#125;</span>/last.json <span class="hljs-string">&quot;suf&quot;</span>)
        yule <span class="hljs-string">&quot;跳转到main3...&quot;</span>
        main3
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 介绍</span>
clear
blank 2
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>本脚本可以将应用所下载的文件转移到你设定的目录<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
blank
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>已支持应用：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;- 哔哩哔哩&quot;</span>
yule <span class="hljs-string">&quot;- 微信&quot;</span>
yule <span class="hljs-string">&quot;- QQ&quot;</span>
yule <span class="hljs-string">&quot;- Nekogram&quot;</span>
blank
sepa
yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>开始[1]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>  退出[2]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>  配置路径[3]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>    我要学习自己适配应用[4]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>

<span class="hljs-comment"># 选择开始菜单</span>
<span class="hljs-keyword">for</span> err_num <span class="hljs-keyword">in</span> &#123;10..0&#125;; <span class="hljs-keyword">do</span>
    sepa
    yulen <span class="hljs-string">&quot;请输入[1]/[2]/[3]/[4]：&quot;</span>
    <span class="hljs-built_in">read</span> menu_1 
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$menu_1</span> <span class="hljs-keyword">in</span>
        1)
            <span class="hljs-comment"># 开始</span>
            clear
            blank 2
            menu
            <span class="hljs-built_in">exit</span> 0
            ;;
        2)
            <span class="hljs-comment"># 退出</span>
            blank
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>脚本已退出，欢迎下次使用<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>          
            <span class="hljs-built_in">exit</span> 0
            ;;
        3)
            <span class="hljs-comment"># 配置路径</span>
            clear
            blank 2
            yulen <span class="hljs-string">&quot;功能研发中，请编辑脚本顶部的 output= 进行配置&quot;</span>
            <span class="hljs-built_in">exit</span> 0
            ;;
        4)
            <span class="hljs-comment"># 使用浏览器打开教程</span>
            am start -a android.intent.action.VIEW -d <span class="hljs-string">&quot;https://baidu.com/&quot;</span>
            <span class="hljs-built_in">exit</span> 0
            ;;
        *|\n)
            <span class="hljs-comment"># 输入错误</span>
            jam <span class="hljs-variable">$err_num</span> <span class="hljs-variable">$menu_1</span>
            ;;
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>

blank
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>你已连续输入错误10次，被系统判定为卡死，已退出脚本&quot;</span></code></pre>
</div></article><div class="copyright-wrapper"><p>原文作者:<a href="https://yulebest.github.io">于乐Yule</a></p><p>原文链接:<a href="https://yulebest.github.io/post12/">缓存转移开源</a></p><p>发表日期: 2024-09-28 08:08:09</p><p>更新日期: 2024-12-05 18:35:12</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/film/001/" title="749局，再次焊上了中国科幻片的大门">上一篇 749局，再次焊上了中国科幻片的大门</a></div><div class="next"> <a href="/post11/" title="缓存转移の自定义适配应用教程">下一篇 缓存转移の自定义适配应用教程</a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: 'YuleBest.github.io',
  owner: 'YuleBest',
  admin: 'YuleBest',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: '缓存转移开源',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>