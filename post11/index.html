<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="于乐Yule"><meta name="description" content="邪王真眼是最强的！"><meta name="keywords" content=""><title>缓存转移の自定义适配应用教程</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github-dark.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;800&amp;display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;800&amp;display=swap"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>缓存转移の自定义适配应用教程</h1><div class="post-info"><span>2024-09-28 07:08:09</span><span class="tags"><a href="/tags/Android%E6%90%9E%E6%9C%BA/">#Android搞机</a><a href="/tags/Shell/">#Shell</a><a href="/tags/%E8%84%9A%E6%9C%AC/">#脚本</a></span></div></div><article> <div class="content"><h2 id="脚本介绍">脚本介绍</h2>
<p>首先，脚本头部写了很多的自定义函数，有：</p>
<ul>
<li>
<p><code>yule &quot;text&quot;</code>：=<code>echo -e &quot; text&quot;</code>。在输出的文本前面加了个空格，方便阅读。</p>
</li>
<li>
<p><code>yulen &quot;text&quot;</code>：=<code>echo -en &quot; text&quot;</code>。</p>
</li>
<li>
<p><code>sepa</code>：=<code>echo &quot;-------------------------------&quot;</code></p>
</li>
<li>
<p><code>blank n</code>：=<code>n</code>个<code>echo &quot;&quot;</code>。输出<code>n</code>个空白行，缺省值为<code>1</code>。</p>
</li>
<li>
<p><code>jsonread [路径/文件名.json] [关键词]</code>：简单的.json读取器</p>
<ul>
<li>
<p>示例 1</p>
<ul>
<li>
<p><code>/data/1.json</code></p>
<pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Nekogram&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;suf&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;all&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;dir&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/storage/emulated/0/Android/data/tw.nekomimi.nekogram/files/Telegram/&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;del&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;no&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2024-09-28 06:29:11&quot;</span><span class="hljs-punctuation">&#125;</span></code></pre>
</li>
<li>
<p>输入</p>
<pre><code class="hljs bash">jsonread /data/1.json del</code></pre>
</li>
<li>
<p>输出</p>
<pre><code class="hljs text">no</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>dlog text</code>：输出普通日志。格式为[日期时间] 操作: [text]</p>
</li>
<li>
<p><code>errlog text</code>：输出错误日志。格式为[日期时间] 错误: [text]</p>
</li>
<li>
<p><code>finlog text</code>：输出完成日志。格式为[日期时间] 完成: [text]</p>
</li>
<li>
<p><code>main</code>：定义各个应用的</p>
<ul>
<li><code>name</code>（应用名）</li>
<li><code>dir</code>（路径）</li>
<li><code>type</code>（1 表示目录用文件夹进行了分类，此时下面的suf不生效；0 表示文件夹内就是要移动的文件）</li>
<li><code>suf</code>（要搜寻的文件后缀名，type 为 1 时不生效，使用 | 分割，all 表示所有文件）</li>
</ul>
</li>
<li>
<p><code>main3</code>：面向某个类型或者应用要进行的操作</p>
</li>
</ul>
<p>以方便你修改。自己适配应用需要修改的有：<code>main</code> <code>main3</code> <code>menu</code> 和底部的<code>脚本介绍</code></p>
<hr>
<h2 id="修改main">修改<code>main</code></h2>
<p>现有的<code>main</code>内容如下：</p>
<pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;
    <span class="hljs-comment"># 定义哔哩哔哩的信息</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;1&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;哔哩哔哩&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/tv.danmaku.bili/download/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-comment"># 哔哩哔哩对视频做了文件夹区分</span>
        suf=<span class="hljs-string">&quot;.m4s|.json&quot;</span>
    <span class="hljs-comment"># 定义微信的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;2&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;微信&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/data/data/com.tencent.mm/MicroMsg/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-comment"># 微信对账号做了文件夹区分</span>
        suf=<span class="hljs-string">&quot;wechat file&quot;</span>
    <span class="hljs-comment"># 定义QQ的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;3&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;QQ&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/com.tencent.mobileqq/Tencent/QQfile_recv/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-comment"># 排除子文件夹</span>
        suf=<span class="hljs-string">&quot;all&quot;</span>
    <span class="hljs-comment"># 定义Nekogram的信息</span>
    <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$menu</span> == <span class="hljs-string">&quot;4&quot;</span> ]]; <span class="hljs-keyword">then</span>
        name=<span class="hljs-string">&quot;Nekogram&quot;</span>
        <span class="hljs-built_in">dir</span>=<span class="hljs-string">&quot;/storage/emulated/0/Android/data/tw.nekomimi.nekogram/files/Telegram/&quot;</span>
        <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;1&quot;</span>
        suf=<span class="hljs-string">&quot;all&quot;</span>
    <span class="hljs-comment"># 此处插入自定义应用代码</span>
    <span class="hljs-keyword">fi</span>
    main2
&#125;</code></pre>
<p>你应该在<code>fi</code>的上一行开始，按格式定义应用的：</p>
<ul>
<li><code>name</code>（应用名）</li>
<li><code>dir</code>（路径）</li>
<li><code>type</code>（1 表示目录用文件夹进行了分类，此时下面的suf不生效；0 表示文件夹内就是要移动的文件）</li>
<li><code>suf</code>（要搜寻的文件后缀名，type 为 1 时不生效，使用 | 分割，all 表示所有文件）</li>
</ul>
<hr>
<h2 id="修改main3">修改<code>main3</code></h2>
<p>现有的<code>main3</code>内容如下：</p>
<pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">main3</span></span>() &#123;
	......
	......
	<span class="hljs-comment"># 此处插入自定义应用代码</span>
	<span class="hljs-comment"># 生成本次配置的 json</span>
    <span class="hljs-built_in">touch</span> <span class="hljs-variable">$&#123;output&#125;</span>/last.json
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&#123;\&quot;name\&quot;:\&quot;<span class="hljs-variable">$name</span>\&quot;,\&quot;type\&quot;:\&quot;<span class="hljs-variable">$type</span>\&quot;,\&quot;suf\&quot;:\&quot;<span class="hljs-variable">$suf</span>\&quot;,\&quot;dir\&quot;:\&quot;<span class="hljs-variable">$dir</span>\&quot;,\&quot;del\&quot;:\&quot;<span class="hljs-variable">$delete</span>\&quot;,\&quot;data\&quot;:\&quot;<span class="hljs-subst">$(date +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span>\&quot;&#125;&quot;</span> &gt; <span class="hljs-variable">$&#123;output&#125;</span>/last.json
    <span class="hljs-built_in">rm</span> -f <span class="hljs-variable">$&#123;output&#125;</span>/error
    <span class="hljs-built_in">exit</span> 0
&#125;</code></pre>
<p>一般情况下，你应在<code>touch $&#123;output&#125;/last.json</code>前添加你要执行的操作，比如：</p>
<pre><code class="hljs bash"><span class="hljs-comment"># 面向 type 1 | suf all 进行的操作</span>
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$type</span> == <span class="hljs-string">&quot;1&quot;</span> &amp;&amp; <span class="hljs-variable">$suf</span> == <span class="hljs-string">&quot;all&quot;</span> ]]; <span class="hljs-keyword">then</span>
    sepa
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>- 复制文件...<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;· 创建./<span class="hljs-variable">$name</span>/&quot;</span>
    <span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span> 2&gt;/dev/null
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    yulen <span class="hljs-string">&quot;· 移动文件到./<span class="hljs-variable">$name</span>/&quot;</span>
    <span class="hljs-built_in">cp</span> -r <span class="hljs-variable">$&#123;dir&#125;</span>* <span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$&#123;name&#125;</span> 2&gt;/<span class="hljs-variable">$&#123;output&#125;</span>/error
    err=$?
    yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span> [完成]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
    <span class="hljs-comment"># 复制成功</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$err</span> == <span class="hljs-string">&quot;0&quot;</span> ]]; <span class="hljs-keyword">then</span>
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>· 复制完成<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        sepa
        <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$delete</span> == <span class="hljs-string">&quot;yes&quot;</span> ]]; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$dir</span>/*
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>删除源文件成功<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        <span class="hljs-keyword">fi</span>
        finlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]转移成功&quot;</span>
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>已完成转移<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yule <span class="hljs-string">&quot;路径<span class="hljs-variable">$&#123;output&#125;</span>/<span class="hljs-variable">$name</span>&quot;</span>
    <span class="hljs-comment"># 复制失败，输出日志</span>
    <span class="hljs-keyword">else</span>
        blank
        sepa
        blank 2                        
        errtext=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;output&#125;</span>/error)           
        yule <span class="hljs-string">&quot;ERR: <span class="hljs-variable">$errtext</span>&quot;</span>
        errlog <span class="hljs-string">&quot;[<span class="hljs-variable">$name</span>]复制文件失败: <span class="hljs-variable">$errtext</span>&quot;</span>
        blank 2
        yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>· 复制出错，请检查：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
        yule <span class="hljs-string">&quot;  1.存储空间是否足够&quot;</span>
        yule <span class="hljs-string">&quot;  2.是否未下载文件&quot;</span>
        yule <span class="hljs-string">&quot;  3.软件是否为旧版&quot;</span>
        yule <span class="hljs-string">&quot;  4.是否未授权Root&quot;</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span></code></pre>
<hr>
<h2 id="修改介绍和选择开始菜单">修改<code>介绍</code>和<code>选择开始菜单</code></h2>
<h4 id="介绍"><code>介绍</code></h4>
<p>现有的<code>介绍</code>位于脚本的<code>525</code>行（<u>v1.0</u>），内容如下：</p>
<pre><code class="hljs bash"><span class="hljs-comment"># 介绍</span>
clear
blank 2
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;YE&#125;</span>本脚本可以将应用所下载的文件转移到你设定的目录<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
blank
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>已支持应用：<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;- 哔哩哔哩&quot;</span>
yule <span class="hljs-string">&quot;- 微信&quot;</span>
yule <span class="hljs-string">&quot;- QQ&quot;</span>
yule <span class="hljs-string">&quot;- Nekogram&quot;</span>
<span class="hljs-comment"># 这里添加新的应用</span>
blank
sepa
yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>开始[1]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>  退出[2]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>  配置路径[3]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>    我要学习自己适配应用[4]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
<span class="hljs-comment"># 这里添加新的序号</span></code></pre>
<p>一般情况下，你只要在上面代码加上新的应用名和序号即可，详见上方注释。</p>
<h4 id="选择开始菜单"><code>选择开始菜单</code></h4>
<p>现有的<code>选择开始菜单</code>位于脚本的<code>542</code>行（<u>v1.0</u>），内容如下：</p>
<pre><code class="hljs bash"><span class="hljs-comment"># 选择开始菜单</span>
<span class="hljs-keyword">for</span> err_num <span class="hljs-keyword">in</span> &#123;10..0&#125;; <span class="hljs-keyword">do</span>
    sepa
    yulen <span class="hljs-string">&quot;请输入[1]/[2]/[3]/[4]：&quot;</span>
    <span class="hljs-built_in">read</span> menu_1 
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$menu_1</span> <span class="hljs-keyword">in</span>
        1)
            <span class="hljs-comment"># 开始</span>
            clear
            blank 2
            menu
            <span class="hljs-built_in">exit</span> 0
            ;;
        2)
            <span class="hljs-comment"># 退出</span>
            blank
            yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>脚本已退出，欢迎下次使用<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>          
            <span class="hljs-built_in">exit</span> 0
            ;;
        3)
            <span class="hljs-comment"># 配置路径</span>
            clear
            blank 2
            yulen <span class="hljs-string">&quot;功能研发中，请编辑脚本顶部的 output= 进行配置&quot;</span>
            <span class="hljs-built_in">exit</span> 0
            ;;
        4)
            <span class="hljs-comment"># 使用浏览器打开教程</span>
            am start -a android.intent.action.VIEW -d <span class="hljs-string">&quot;https://baidu.com/&quot;</span>
            <span class="hljs-built_in">exit</span> 0
            ;;
        n)
			......
			;;
        *|\n)
            <span class="hljs-comment"># 输入错误</span>
            jam <span class="hljs-variable">$err_num</span> <span class="hljs-variable">$menu_1</span>
            ;;
		
			
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>

blank
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>你已连续输入错误10次，被系统判定为卡死，已退出脚本&quot;</span></code></pre>
<p>这里被<code>介绍</code>的</p>
<pre><code class="hljs bash">yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;GR&#125;</span>开始[1]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yulen <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RE&#125;</span>  退出[2]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;CY&#125;</span>  配置路径[3]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span>
yule <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;BL&#125;</span>    我要学习自己适配应用[4]<span class="hljs-variable">$&#123;RES&#125;</span>&quot;</span></code></pre>
<p>所选择，只要在<code>*|\n)</code>的上一行添加</p>
<pre><code class="hljs bash">[序号])
    [操作]
    ;;</code></pre>
<p>就可以了。</p>
<hr>
<h2 id="相关内容">相关内容</h2>
<p><a href="https://yulebest.github.io/post12/"> 缓存转移开源 | YuleのBlog - Post 12</a></p>
<p><a target="_blank" rel="noopener" href="https://www.123865.com/s/iBeVVv-QKhV"> 缓存转移下载 | 123云盘</a></p>
</div></article><div class="copyright-wrapper"><p>原文作者:<a href="https://yulebest.github.io">于乐Yule</a></p><p>原文链接:<a href="https://yulebest.github.io/post11/">缓存转移の自定义适配应用教程</a></p><p>发表日期: 2024-09-28 07:08:09</p><p>更新日期: 2024-12-05 18:35:12</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/post12/" title="缓存转移开源">上一篇 缓存转移开源</a></div><div class="next"> <a href="/post10/" title="国务院食安办通报对媒体反映的“罐车运输食用植物油乱象问题”调查处置情况（转载测试）">下一篇 国务院食安办通报对媒体反映的“罐车运输食用植物油乱象问题”调查处置情况（转载测试）</a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: 'YuleBest.github.io',
  owner: 'YuleBest',
  admin: 'YuleBest',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: '缓存转移の自定义适配应用教程',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>