<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="于乐Yule"><meta name="description" content="邪王真眼是最强的！"><meta name="keywords" content=""><title>下载重定向模块开源</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/github-dark.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;800&amp;display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;800&amp;display=swap"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 7.3.0"></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>下载重定向模块开源</h1><div class="post-info"><span>2024-08-25 19:09:12</span><span class="tags"><a href="/tags/Android%E6%90%9E%E6%9C%BA/">#Android搞机</a><a href="/tags/%E5%88%B7%E6%9C%BA/">#刷机</a><a href="/tags/%E6%8A%80%E6%9C%AF%E5%B8%96/">#技术帖</a></span></div></div><article> <div class="content"><h2 id="文件结构：">文件结构：</h2>
<h5 id="下载重定向v1-0-zip">下载重定向v1.0.zip</h5>
<p>|-- <strong>common</strong><br>
|	|-- config.conf<br>
|	|-- <a target="_blank" rel="noopener" href="http://post-fs-data.sh">post-fs-data.sh</a><br>
|	|-- system.prop<br>
|	|-- log.txt<br>
|	|-- <a target="_blank" rel="noopener" href="http://service.sh">service.sh</a><br>
|-- <strong>META-INF</strong><br>
|	|-- <strong>com</strong><br>
|		|-- <strong>google</strong><br>
|			|-- <strong>android</strong><br>
|				|-- update-binary<br>
|				|-- update-script<br>
|-- <strong>system</strong><br>
|-- module.prop<br>
|-- <a target="_blank" rel="noopener" href="http://customize.sh">customize.sh</a><br>
|-- <a target="_blank" rel="noopener" href="http://uninstall.sh">uninstall.sh</a></p>
<hr>
<h2 id="文件内容：">文件内容：</h2>
<p>|-- <strong>common</strong><br>
|	|-- config.conf</p>
<pre><code class="hljs plaintext">

#配置说明：
#SDIR是原路径，
#TDIR是目标路径，
#TS是刷新延迟(默认5s)。
#RM表示是否删除原目录，填1在每次移动完成后都会删除原来的目录，填0不会（慎用）

#路径以/结尾
    
#例如
#SDIR=/sdcard/a/
#TDIR=/sdcard/b/
#RM=1

#TS=5

#模块就会每隔5s扫描/sdcard/a/下的文件，如果没有下载中的文件，就会把文件移动到/sdcard/b/，并且删除/sdcard/a
    
    
#-----  配置区域  -----

TS=5

SDIR1=
TDIR1=
RM1=0

SDIR2=
TDIR2=
RM2=0

SDIR3=
TDIR3=
RM3=0

SDIR3=
TDIR3=
RM3=0

SDIR4=
TDIR4=
RM4=0

SDIR5=
TDIR5=
RM5=0

SDIR6=
TDIR6=
RM6=0

SDIR7=
TDIR7=
RM7=0

SDIR8=
TDIR8=
RM8=0

SDIR9=
TDIR9=
RM9=0

SDIR10=
TDIR10=
RM10=0</code></pre>
<p>|-- <strong>common</strong><br>
|	|-- <a target="_blank" rel="noopener" href="http://post-fs-data.sh">post-fs-data.sh</a></p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/system/bin/sh</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">请不要硬编码/magisk/modname/...;相反，请使用<span class="hljs-variable">$MODDIR</span>/...</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">这将使您的脚本兼容，即使Magisk以后改变挂载点</span>
MODDIR=$&#123;0%/*&#125;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">此脚本将在post-fs-data模式下执行</span></code></pre>
<p>|-- <strong>common</strong><br>
|	|-- system.prop</p>
<pre><code class="hljs plaintext"># This file will be read by resetprop
# 示例: 更改 dpi
# ro.sf.lcd_density=360
# vendor.display.lcd_density=360
# 此文件映射 /system/build.prop</code></pre>
<p>|-- <strong>common</strong><br>
|	|-- <a target="_blank" rel="noopener" href="http://service.sh">service.sh</a></p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/system/bin/sh</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">请不要硬编码/magisk/modname/...;相反，请使用<span class="hljs-variable">$MODDIR</span>/...</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">这将使您的脚本兼容，即使Magisk以后改变挂载点</span>


MODDIR=$&#123;0%/*&#125;
LOG=$MODDIR/log.txt
counter=0
config_file=$MODDIR/config.txt
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">该脚本将在设备开机后作为延迟服务启动</span>
while true; do
    while [ &quot;$(getprop sys.boot_completed)&quot; != &quot;1&quot; ]; do
        sleep 20
    done
    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
    echo &quot;👌[$time] 开机完成，已进入循环&quot; &gt;&gt; $LOG    
  
    #获取变量
    configs=&quot;$(cat &quot;$MODDIR/config.conf&quot; | egrep -v &#x27;^#&#x27;)&quot;
	
    #分割变量提纯
    SDIR1=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR1=/&#123;print $2&#125;&#x27;)
    SDIR2=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR2=/&#123;print $2&#125;&#x27;)
    SDIR3=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR3=/&#123;print $2&#125;&#x27;)
	SDIR4=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR4=/&#123;print $2&#125;&#x27;)
    SDIR5=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR5=/&#123;print $2&#125;&#x27;)
    SDIR6=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR6=/&#123;print $2&#125;&#x27;)
	SDIR7=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR7=/&#123;print $2&#125;&#x27;)
    SDIR8=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR8=/&#123;print $2&#125;&#x27;)
    SDIR9=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR9=/&#123;print $2&#125;&#x27;)
	SDIR10=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^SDIR10=/&#123;print $2&#125;&#x27;)

    TDIR1=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR1=/&#123;print $2&#125;&#x27;)
    TDIR2=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR2=/&#123;print $2&#125;&#x27;)
    TDIR3=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR3=/&#123;print $2&#125;&#x27;)
	TDIR4=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR4=/&#123;print $2&#125;&#x27;)
    TDIR5=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR5=/&#123;print $2&#125;&#x27;)
    TDIR6=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR6=/&#123;print $2&#125;&#x27;)
	TDIR7=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR7=/&#123;print $2&#125;&#x27;)
    TDIR8=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR8=/&#123;print $2&#125;&#x27;)
    TDIR9=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR9=/&#123;print $2&#125;&#x27;)
	TDIR10=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TDIR10=/&#123;print $2&#125;&#x27;)
	
	RM1=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM1=/&#123;print $2&#125;&#x27;)
    RM2=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM2=/&#123;print $2&#125;&#x27;)
    RM3=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM3=/&#123;print $2&#125;&#x27;)
	RM4=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM4=/&#123;print $2&#125;&#x27;)
    RM5=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM5=/&#123;print $2&#125;&#x27;)
    RM6=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM6=/&#123;print $2&#125;&#x27;)
	RM7=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM7=/&#123;print $2&#125;&#x27;)
    RM8=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM8=/&#123;print $2&#125;&#x27;)
    RM9=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM9=/&#123;print $2&#125;&#x27;)
	RM10=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^RM10=/&#123;print $2&#125;&#x27;)
	
	TS=$(echo &quot;$configs&quot; | awk -F &#x27;=&#x27; &#x27;/^TS=/&#123;print $2&#125;&#x27;)
<span class="hljs-meta prompt_">	</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR1 -&gt; TDIR1---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR1&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR1&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR1
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录1] 检测到$TDIR1(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录1] 检测到$TDIR1(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR1&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录1] 检测到$SDIR1(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp1=$(find $SDIR1 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp1&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录1] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录1] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR1 | wc -l)       
                    #移动文件
                    mv $SDIR1* $TDIR1
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM1&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR1&quot;
                        echo &quot;✅[$time] [目录1] 已为您删除$SDIR1(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录1]$SDIR1
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录1] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录1] 检测到$SDIR1(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录1] 检测到$TDIR1(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
    
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR2 -&gt; TDIR2---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR2&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR2&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR2
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录2] 检测到$TDIR2目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录2] 检测到$TDIR2(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR2&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录2] 检测到$SDIR2(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp2=$(find $SDIR2 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp2&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录2] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录2] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR2 | wc -l)       
                    #移动文件
                    mv $SDIR2* $TDIR2
                    
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM2&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR2&quot;
                        echo &quot;✅[$time] [目录2] 已为您删除$SDIR2(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录2]$SDIR2
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录2] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录2] 检测到$SDIR2(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录2] 检测到$TDIR2(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
    
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR3 -&gt; TDIR3---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR3&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR3&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR3
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录3] 检测到$TDIR3(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录3] 检测到$TDIR3(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR3&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录3] 检测到$SDIR3(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp3=$(find $SDIR3 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp3&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录3] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录3] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR3 | wc -l)       
                    #移动文件
                    mv $SDIR3* $TDIR3
                    
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM3&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR3&quot;
                        echo &quot;✅[$time] [目录3] 已为您删除$SDIR3(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录3]$SDIR3
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录3] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录3] 检测到$SDIR3(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录3] 检测到$TDIR3(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕   
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR4 -&gt; TDIR4---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR4&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR4&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR4
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录4] 检测到$TDIR4(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录4] 检测到$TDIR4(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR4&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录4] 检测到$SDIR4(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp4=$(find $SDIR4 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp4&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录4] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录4] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR4 | wc -l)       
                    #移动文件
                    mv $SDIR4* $TDIR4
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM4&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR4&quot;
                        echo &quot;✅[$time] [目录4] 已为您删除$SDIR4(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录4]$SDIR4
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录4] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录4] 检测到$SDIR4(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录4] 检测到$TDIR4(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
    
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR5 -&gt; TDIR5---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR5&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR5&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR5
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录5] 检测到$TDIR5(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录5] 检测到$TDIR5(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR5&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录5] 检测到$SDIR5(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp5=$(find $SDIR5 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp5&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录5] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录5] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR5 | wc -l)       
                    #移动文件
                    mv $SDIR5* $TDIR5
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM5&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR5&quot;
                        echo &quot;✅[$time] [目录5] 已为您删除$SDIR5(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录5]$SDIR5
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录5] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录5] 检测到$SDIR5(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录5] 检测到$TDIR5(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR6 -&gt; TDIR6---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR6&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR6&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR6
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录6] 检测到$TDIR6(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录6] 检测到$TDIR6(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR6&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录6] 检测到$SDIR6(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp6=$(find $SDIR6 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp6&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录6] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录6] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR6 | wc -l)       
                    #移动文件
                    mv $SDIR6* $TDIR6
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM6&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR6&quot;
                        echo &quot;✅[$time] [目录6] 已为您删除$SDIR6(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录6]$SDIR6
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录6] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录6] 检测到$SDIR6(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录6] 检测到$TDIR6(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR7 -&gt; TDIR7---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR7&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR7&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR7
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录7] 检测到$TDIR7(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录7] 检测到$TDIR7(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR7&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录7] 检测到$SDIR7(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp7=$(find $SDIR7 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp7&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录7] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录7] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR7 | wc -l)       
                    #移动文件
                    mv $SDIR7* $TDIR7
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM7&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR7&quot;
                        echo &quot;✅[$time] [目录7] 已为您删除$SDIR7(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录7]$SDIR7
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录7] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录7] 检测到$SDIR7(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录7] 检测到$TDIR7(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR6 -&gt; TDIR6---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR6&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR6&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR6
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录6] 检测到$TDIR6(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录6] 检测到$TDIR6(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR6&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录6] 检测到$SDIR6(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp6=$(find $SDIR6 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp6&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录6] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录6] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR6 | wc -l)       
                    #移动文件
                    mv $SDIR6* $TDIR6
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM6&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR6&quot;
                        echo &quot;✅[$time] [目录6] 已为您删除$SDIR6(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录6]$SDIR6
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录6] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录6] 检测到$SDIR6(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录6] 检测到$TDIR6(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR9 -&gt; TDIR9---------------------</span>

    #检查TDIR路径是否为空
    if [[ &quot;$TDIR9&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR9&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR9
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录9] 检测到$TDIR9(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录9] 检测到$TDIR9(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR9&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录9] 检测到$SDIR9(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp9=$(find $SDIR9 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp9&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录9] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录9] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR9 | wc -l)       
                    #移动文件
                    mv $SDIR9* $TDIR9
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM9&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR9&quot;
                        echo &quot;✅[$time] [目录9] 已为您删除$SDIR9(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录9]$SDIR9
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录9] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录9] 检测到$SDIR9(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录9] 检测到$TDIR9(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------SDIR10 -&gt; TDIR10---------------------</span>
    #检查TDIR路径是否为空
    if [[ &quot;$TDIR10&quot; != &quot;&quot; ]]; then
        #若TIDR路径不为空
        #检查TIR是否存在
        if [ ! -d &quot;$TDIR10&quot; ]; then
        #若不存在，则创建路径并生成日志
            mkdir -p $TDIR10
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录10] 检测到$TDIR10(目标目录)目录不存在，已创建目录&quot; &gt;&gt; $LOG        
        else    #若存在，则进入下一层判断
            #生成日志
            time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
            echo &quot;👌[$time] [目录10] 检测到$TDIR10(目标目录)目录已存在&quot; &gt;&gt; $LOG
            #检查SDIR路径是否为空
            if [[ &quot;$SDIR10&quot; != &quot;&quot; ]];then
            #若不为空
                #生成日志，后进行下载状态判断
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;👌[$time] [目录10] 检测到$SDIR10(原目录)目录已存在&quot; &gt;&gt; $LOG
                #检查SDIR目录下是否有.tmp文件
                tmp10=$(find $SDIR10 -type f -name &#x27;*.tmp&#x27;)
                if [ -n &quot;$tmp10&quot; ]; then
                    #如果有，生成日志，进入下一次循环
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;❗️[$time] [目录10] 已发现下载中的文件，不进行移动，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                else    #如果没有，则进行文件移动
                    #生成日志
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;👌[$time] [目录10] 未发现下载中的文件，开始移动文件&quot; &gt;&gt; $LOG
                    #获取要移动的文件数量
                    files_to_move=$(ls $SDIR10 | wc -l)       
                    #移动文件
                    mv $SDIR10* $TDIR10
                                       
                    #判断是否删除目录
                    #检查 $RM 是否等于 1
                    if [ &quot;$RM10&quot; -eq 1 ]; then
                        #如果 $RM 等于 1，则删除目录 $SDIR
                        rm -rf &quot;$SDIR10&quot;
                        echo &quot;✅[$time] [目录10] 已为您删除$SDIR10(原目录)&quot;
                    #如果 $RM 不等于 1，则不执行任何操作
                    fi
                    
                    #更新计数器
                    counter=$((counter + files_to_move))
                    title=&quot;最新移动位于[目录10]$SDIR10
                    ✅本模块共为您移动了 $counter 个文件！&quot;
                    time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                    echo &quot;✅[$time] [目录10] 第$counter个文件移动已完成，计数器更新完毕，进入下一次循环
        ----------------------------------------&quot; &gt;&gt; $LOG
                fi    #下载状态判断结束
            else    #如果SDIR路径为空
                #生成日志
                time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
                echo &quot;🚫[$time] [目录10] 检测到$SDIR10(原目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG
                  
            fi    #SDIR路径是否为空判断结束                
        fi    #TDIR是否存在判断结束
    else    #若TDIR路径为空
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🚫[$time] [目录10] 检测到$TDIR10(目标目录)路径未填写，跳过移动&quot; &gt;&gt; $LOG       
    fi    #TDIR路径是否为空判断完毕
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">----------------一轮文件移动完成---------------------</span>      
 
    #更新计数器
    sed -i &#x27;/^description=/d&#x27; $MODDIR/module.prop
    echo &quot;description=$&#123;title&#125;&quot; &gt;&gt;$MODDIR/module.prop
    
    #删日志
    #获取日志的行数
    line_count=$(wc -l &lt; $LOG)
    #检查行数是否超过1024
    if [ $line_count -gt 10000 ]; then
        #删除前128行
        awk &#x27;NR&gt;1000&#x27; $LOG &gt; $MODDIR/temp.txt &amp;&amp; mv $MODDIR/temp.txt $LOG
        time=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)
        echo &quot;🔪[$time] 日志已满10000行，自动删除前1000行&quot; &gt;&gt; $LOG
    fi
    
    
    #睡眠5秒
    sleep $TS
done</code></pre>
<p>|-- <strong>common</strong><br>
|	|-- log.txt</p>
<pre><code class="hljs plaintext"></code></pre>
<p>|-- <strong>META-INF</strong><br>
|	|-- <strong>com</strong><br>
|		|-- <strong>google</strong><br>
|			|-- <strong>android</strong><br>
|				|-- update-binary</p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/sbin/sh</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Initialization</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">################</span></span>

umask 022
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">echo</span> before loading util_functions</span>
ui_print() &#123; echo &quot;$1&quot;; &#125;

ui_print &quot;*******************************&quot;

require_new_magisk() &#123;
  ui_print &quot;*******************************&quot;
  ui_print &quot; Please install Magisk v20.4+! &quot;
  ui_print &quot;*******************************&quot;
  exit 1
&#125;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">########################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Load util_functions.sh</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">########################</span></span>

OUTFD=$2
ZIPFILE=$3

mount /data 2&gt;/dev/null

[ -f /data/adb/magisk/util_functions.sh ] || require_new_magisk
. /data/adb/magisk/util_functions.sh
[ $MAGISK_VER_CODE -lt 20400 ] &amp;&amp; require_new_magisk

install_module
exit 0</code></pre>
<p>|-- <strong>META-INF</strong><br>
|	|-- <strong>com</strong><br>
|		|-- <strong>google</strong><br>
|			|-- <strong>android</strong><br>
|				|-- update-script</p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">MAGISK</span>
</code></pre>
<p>|-- module.prop</p>
<pre><code class="hljs properties"><span class="hljs-attr">id</span>=<span class="hljs-string">DownloadHelper</span>
<span class="hljs-attr">name</span>=<span class="hljs-string">下载重定向</span>
<span class="hljs-attr">version</span>=<span class="hljs-string">3.0</span>
<span class="hljs-attr">versionCode</span>=<span class="hljs-string">28</span>
<span class="hljs-attr">author</span>=<span class="hljs-string">于乐Yule</span>
<span class="hljs-attr">description</span>=<span class="hljs-string">模块刷入成功，请重启手机～</span></code></pre>
<p>|-- <a target="_blank" rel="noopener" href="http://customize.sh">customize.sh</a></p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"></span>
<span class="language-bash"><span class="hljs-comment"># Magisk Module Template Config Script</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">by 小白杨</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"></span>
<span class="language-bash"><span class="hljs-comment">##########################################################################################</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"></span>
<span class="language-bash"><span class="hljs-comment"># Instructions:</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"></span>
<span class="language-bash"><span class="hljs-comment"># 1. Place your files into system folder (delete the placeholder file)</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">2. Fill <span class="hljs-keyword">in</span> your module<span class="hljs-string">&#x27;s info into module.prop</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">3. Configure the settings in this file (config.sh)</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">4. If you need boot scripts, add them into common/post-fs-data.sh or common/service.sh</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">5. Add your additional or modified system properties into common/system.prop</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string"></span></span>
<span class="hljs-string"><span class="language-bash">##########################################################################################</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Configs</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Set to true if you need to enable Magic Mount</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Most mods would like it to be enabled</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Installation Message</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Set what you want to show when installing your mod</span></span>

print_modname() &#123;
  ui_print &quot;*******************************&quot;
  ui_print &quot;         By 于乐Yule&quot;
  ui_print &quot;*******************************&quot;
&#125;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Replace list</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string">#########################################################################################</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">List all directories you want to directly replace in the system</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Check the documentations for more info about how Magic Mount works, and why you need this</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">This is an example</span></span>
REPLACE=&quot;
/system/app/Youtube
/system/priv-app/SystemUI
/system/priv-app/Settings
/system/framework
&quot;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">Construct your own list here, it will override the example above</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">!DO NOT! remove this if you don&#x27;</span>t need to replace anything, leave it empty as it is now</span>
REPLACE=&quot;

&quot;
<span class="hljs-meta prompt_">#</span><span class="language-bash">添加您要精简的APP/文件夹目录</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">例如：精简状态栏，找到状态栏目录为  /system/priv-app/SystemUI/SystemUI.apk</span>     
<span class="hljs-meta prompt_">#</span><span class="language-bash">转化加入:/system/priv-app/SystemUI</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">（可以搭配高级设置获取APP目录）</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Permissions</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash">释放文件，普通shell命令</span>
on_install() &#123;
  ui_print &quot;- 正在为主人刷入中喵～&quot;
  unzip -o &quot;$ZIPFILE&quot; &#x27;system/*&#x27; -d $MODPATH &gt;&amp;2
&#125;

set_permissions() &#123;
<span class="hljs-meta prompt_">  # </span><span class="language-bash">Only some special files require specific permissions</span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">The default permissions should be good enough <span class="hljs-keyword">for</span> most cases</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">Here are some examples <span class="hljs-keyword">for</span> the set_perm <span class="hljs-built_in">functions</span>:</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm_recursive  &lt;<span class="hljs-built_in">dirname</span>&gt;                &lt;owner&gt; &lt;group&gt; &lt;dirpermission&gt; &lt;filepermission&gt; &lt;contexts&gt; (default: u:object_r:system_file:s0)</span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm_recursive  <span class="hljs-variable">$MODPATH</span>/system/lib       0       0       0755            0644</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm  &lt;filename&gt;                         &lt;owner&gt; &lt;group&gt; &lt;permission&gt; &lt;contexts&gt; (default: u:object_r:system_file:s0)</span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm  <span class="hljs-variable">$MODPATH</span>/system/bin/app_process32   0       2000    0755         u:object_r:zygote_exec:s0</span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm  <span class="hljs-variable">$MODPATH</span>/system/bin/dex2oat         0       2000    0755         u:object_r:dex2oat_exec:s0</span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">set_perm  <span class="hljs-variable">$MODPATH</span>/system/lib/libart.so       0       0       0644</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">  # </span><span class="language-bash">The following is default permissions, DO NOT remove</span>
  set_perm_recursive  $MODPATH  0  0  0755  0644
  
<span class="hljs-meta prompt_">  #</span><span class="language-bash">设置权限，基本不要去动</span>
&#125;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Custom Functions</span>
<span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#########################################################################################</span></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">This file (config.sh) will be sourced by the main flash script after util_functions.sh</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">If you need custom logic, please add them here as <span class="hljs-built_in">functions</span>, and call these <span class="hljs-built_in">functions</span> <span class="hljs-keyword">in</span></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">update-binary. Refrain from adding code directly into update-binary, as it will make it</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">difficult <span class="hljs-keyword">for</span> you to migrate your modules to newer template versions.</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Make update-binary as clean as possible, try to only <span class="hljs-keyword">do</span> <span class="hljs-keyword">function</span> calls <span class="hljs-keyword">in</span> it.</span>


CommonPath=$MODPATH/common
if [ ! -d $&#123;CommonPath&#125; ];then
  ui_print &quot;模块高级设置不需要修复!&quot;
  
elif [ &quot;`ls -A $&#123;CommonPath&#125;`&quot; = &quot;&quot; ];then
    ui_print &quot;模块高级设置为空!&quot;
    rm  -rf  $&#123;CommonPath&#125;
else

  ui_print &quot;- 正在努力为主人刷入中喵～&quot;
  mv  $&#123;CommonPath&#125;/*  $MODPATH
  rm  -rf $&#123;CommonPath&#125;
  ui_print &quot;*******************************&quot;
  ui_print &quot;刷入成功～&quot;
  ui_print &quot;请重启后前往
  /data/adb/modules/DownloadHelper/config.conf
  配置哦～～&quot;
  ui_print &quot;日志位于/data/adb/modules/DownloadHelper/log.txt&quot;
fi


</code></pre>
<p>|-- <a target="_blank" rel="noopener" href="http://uninstall.sh">uninstall.sh</a></p>
<pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">卸载模块时候执行的脚本</span></code></pre>
<hr>
<p>by 于乐Yule</p>
</div></article><div class="copyright-wrapper"><p>原文作者:<a href="https://yulebest.github.io">于乐Yule</a></p><p>原文链接:<a href="https://yulebest.github.io/post9/">下载重定向模块开源</a></p><p>发表日期: 2024-08-25 19:09:12</p><p>更新日期: 2024-12-05 18:25:47</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/post10/" title="国务院食安办通报对媒体反映的“罐车运输食用植物油乱象问题”调查处置情况（转载测试）">上一篇 国务院食安办通报对媒体反映的“罐车运输食用植物油乱象问题”调查处置情况（转载测试）</a></div><div class="next"> <a href="/post8/" title="思修·1-1 科学认识人的本质">下一篇 思修·1-1 科学认识人的本质</a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: 'YuleBest.github.io',
  owner: 'YuleBest',
  admin: 'YuleBest',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: '下载重定向模块开源',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>